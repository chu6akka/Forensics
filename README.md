# Анализ словоформ для судебной лингвистики

Небольшое настольное приложение на Python для анализа русскоязычного текста:

- определяет начальную форму (лемму) каждого слова;
- считает количество словоформ каждой леммы;
- выводит список всех встреченных словоформ с указанием части речи (на русском языке);
- экспортирует результат в Excel;
- считает частотные коэффициенты частей речи, показывает таблицу подсчётов и круговую диаграмму.

## Установка

1. Установите Python 3.11+.
2. Установите зависимости:

```bash
pip install -r requirements.txt
```

## Запуск

```bash
python app.py
```

## Как пользоваться

1. Введите текст в окно.
2. Нажмите **«Проверить»**.
3. Посмотрите результаты в таблице.
4. При необходимости нажмите **«Экспорт в Excel»** и сохраните файл `.xlsx`.
5. Для визуализации нажмите **«Показать коэффициенты»**.

## Примечания

- Для контекстного морфологического анализа используется `stanza` (нейросетевая
  модель), что помогает различать омонимичные формы по контексту.
- При ошибках `WeightsUnpickler` в новых версиях PyTorch приложение добавляет
  разрешённый тип восстановления `numpy` для загрузки моделей Stanza.
- Для совместимости со Stanza зафиксирована версия `torch==2.6.0`, потому что
  более старые версии могут быть недоступны в используемом индексе пакетов.
- Если модель `stanza` недоступна, используется резервный анализ `pymorphy3`,
  который поддерживает категории русского языка (включая деепричастия и причастия).
- Список словоформ хранится в нижнем регистре и сопровождается частью речи.
- Частотный коэффициент части речи = количество слов этой части речи / общее
  количество слов в тексте.
